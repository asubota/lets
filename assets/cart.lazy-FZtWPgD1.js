import{j as t,r as b,d as W,s as G}from"./tanstack-DrrzDSOT.js";import{d as A,B as a,Q as N,x as B,I as y,g as H,e as X,m as K}from"./mui-DvpnWA7j.js";import{A as k,H as F,b as Q,u as V,f as J,D as Z}from"./index-D-OGMcvX.js";import{u as _,a as tt,b as nt}from"./cart-api-B6NOUdpW.js";import"./react-_uqhELNW.js";import"./html2canvas-BfYXEYrK.js";import"./tesseract-efYOn2sj.js";import"./swiper-B72pzicN.js";const U=A(t.jsx("path",{d:"M19 13H5v-2h14z"}),"Remove"),et=A(t.jsx("path",{d:"M22.73 22.73 2.77 2.77 2 2l-.73-.73L0 2.54l4.39 4.39 2.21 4.66-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h7.46l1.38 1.38c-.5.36-.83.95-.83 1.62 0 1.1.89 2 1.99 2 .67 0 1.26-.33 1.62-.84L21.46 24zM7.42 15c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h2.36l2 2zm8.13-2c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H6.54zM7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2"}),"RemoveShoppingCart"),st="Left",it="Right",ot="Up",ct="Down",S={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:1/0,touchEventOptions:{passive:!0}},D={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},P="mousemove",q="mouseup",rt="touchend",at="touchmove",ut="touchstart";function lt(e,r,u,o){return e>r?u>0?it:st:o>0?ct:ot}function z(e,r){if(r===0)return e;const u=Math.PI/180*r,o=e[0]*Math.cos(u)+e[1]*Math.sin(u),h=e[1]*Math.cos(u)-e[0]*Math.sin(u);return[o,h]}function dt(e,r){const u=n=>{const s="touches"in n;s&&n.touches.length>1||e((i,c)=>{c.trackMouse&&!s&&(document.addEventListener(P,o),document.addEventListener(q,m));const{clientX:p,clientY:f}=s?n.touches[0]:n,g=z([p,f],c.rotationAngle);return c.onTouchStartOrOnMouseDown&&c.onTouchStartOrOnMouseDown({event:n}),Object.assign(Object.assign(Object.assign({},i),D),{initial:g.slice(),xy:g,start:n.timeStamp||0})})},o=n=>{e((s,i)=>{const c="touches"in n;if(c&&n.touches.length>1)return s;if(n.timeStamp-s.start>i.swipeDuration)return s.swiping?Object.assign(Object.assign({},s),{swiping:!1}):s;const{clientX:p,clientY:f}=c?n.touches[0]:n,[g,M]=z([p,f],i.rotationAngle),v=g-s.xy[0],I=M-s.xy[1],w=Math.abs(v),O=Math.abs(I),C=(n.timeStamp||0)-s.start,Y=Math.sqrt(w*w+O*O)/(C||1),$=[v/(C||1),I/(C||1)],E=lt(w,O,v,I),L=typeof i.delta=="number"?i.delta:i.delta[E.toLowerCase()]||S.delta;if(w<L&&O<L&&!s.swiping)return s;const T={absX:w,absY:O,deltaX:v,deltaY:I,dir:E,event:n,first:s.first,initial:s.initial,velocity:Y,vxvy:$};T.first&&i.onSwipeStart&&i.onSwipeStart(T),i.onSwiping&&i.onSwiping(T);let R=!1;return(i.onSwiping||i.onSwiped||i[`onSwiped${E}`])&&(R=!0),R&&i.preventScrollOnSwipe&&i.trackTouch&&n.cancelable&&n.preventDefault(),Object.assign(Object.assign({},s),{first:!1,eventData:T,swiping:!0})})},h=n=>{e((s,i)=>{let c;if(s.swiping&&s.eventData){if(n.timeStamp-s.start<i.swipeDuration){c=Object.assign(Object.assign({},s.eventData),{event:n}),i.onSwiped&&i.onSwiped(c);const p=i[`onSwiped${c.dir}`];p&&p(c)}}else i.onTap&&i.onTap({event:n});return i.onTouchEndOrOnMouseUp&&i.onTouchEndOrOnMouseUp({event:n}),Object.assign(Object.assign(Object.assign({},s),D),{eventData:c})})},d=()=>{document.removeEventListener(P,o),document.removeEventListener(q,m)},m=n=>{d(),h(n)},x=(n,s)=>{let i=()=>{};if(n&&n.addEventListener){const c=Object.assign(Object.assign({},S.touchEventOptions),s.touchEventOptions),p=[[ut,u,c],[at,o,Object.assign(Object.assign({},c),s.preventScrollOnSwipe?{passive:!1}:{})],[rt,h,c]];p.forEach(([f,g,M])=>n.addEventListener(f,g,M)),i=()=>p.forEach(([f,g])=>n.removeEventListener(f,g))}return i},l={ref:n=>{n!==null&&e((s,i)=>{if(s.el===n)return s;const c={};return s.el&&s.el!==n&&s.cleanUpTouch&&(s.cleanUpTouch(),c.cleanUpTouch=void 0),i.trackTouch&&n&&(c.cleanUpTouch=x(n,i)),Object.assign(Object.assign(Object.assign({},s),{el:n}),c)})}};return r.trackMouse&&(l.onMouseDown=u),[l,x]}function ht(e,r,u,o){return!r.trackTouch||!e.el?(e.cleanUpTouch&&e.cleanUpTouch(),Object.assign(Object.assign({},e),{cleanUpTouch:void 0})):e.cleanUpTouch?r.preventScrollOnSwipe!==u.preventScrollOnSwipe||r.touchEventOptions.passive!==u.touchEventOptions.passive?(e.cleanUpTouch(),Object.assign(Object.assign({},e),{cleanUpTouch:o(e.el,r)})):e:Object.assign(Object.assign({},e),{cleanUpTouch:o(e.el,r)})}function xt(e){const{trackMouse:r}=e,u=b.useRef(Object.assign({},D)),o=b.useRef(Object.assign({},S)),h=b.useRef(Object.assign({},o.current));h.current=Object.assign({},o.current),o.current=Object.assign(Object.assign({},S),e);let d;for(d in S)o.current[d]===void 0&&(o.current[d]=S[d]);const[m,x]=b.useMemo(()=>dt(j=>u.current=j(u.current,o.current),{trackMouse:r}),[r]);return u.current=ht(u.current,o.current,h.current,x),m}const pt="ontouchstart"in window||navigator.maxTouchPoints>0,ft=({children:e,actions:r})=>{const[u,o]=b.useState(!1),m=xt({onSwipedLeft:()=>o(!0),onSwipedRight:()=>o(!1),preventScrollOnSwipe:!0}),x=b.useRef(null);b.useEffect(()=>{const l=n=>{x.current&&!x.current.contains(n.target)&&o(!1)};return document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[]);const j=l=>{m.ref(l),x.current=l};return t.jsxs(a,{...m,ref:j,sx:{position:"relative",overflow:"hidden",mb:2,"&:hover .top-actions":{display:"block"}},children:[t.jsx(a,{sx:{flex:1},children:e}),!pt&&t.jsx(a,{className:"top-actions",sx:{display:"none",position:"absolute",right:0,top:0},children:r}),t.jsx(a,{sx:{position:"absolute",right:0,top:0,bottom:0,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",transition:"transform 0.3s ease",transform:u?"translateX(0)":"translateX(100%)"},children:r})]})},mt=({item:e})=>{var m,x;const r=parseInt(e.discount,10),u=parseInt(e.quantity,10),o=((m=e.product)==null?void 0:m.price)||0,h=o-o*r/100,{mutate:d}=_();return t.jsxs(N,{variant:"elevation",sx:{p:1},children:[t.jsxs(a,{sx:{mb:2},children:[" ",(x=e.product)==null?void 0:x.name]}),t.jsx(B,{}),h===o&&t.jsxs(a,{sx:{pt:1,pb:1},children:["Ціна:"," ",t.jsx(a,{component:"span",sx:{fontWeight:"bold"},children:o})," ","грн"]}),h!==o&&t.jsxs(a,{sx:{pt:1,pb:1,display:"flex",alignItems:"center"},children:["Ціна:",t.jsxs(a,{component:"span",sx:{ml:"4px",fontSize:"14px",position:"relative"},children:[o," грн",t.jsx(a,{sx:{position:"absolute",backgroundColor:"red",width:"calc(100% + -10px)",height:"2px",transform:"rotate(-18deg)",left:"-8px",bottom:"11px",borderRadius:"2px"}})]}),t.jsxs(a,{component:"span",sx:{fontWeight:"bold",color:"success.main",ml:"4px"},children:[h.toFixed(2)," грн"]}),t.jsxs(a,{component:"span",sx:{fontWeight:"bold",color:"primary.main",fontSize:"15px",ml:"auto"},children:[Math.ceil(o*r/100)," грн"]})]}),t.jsxs(a,{sx:{pt:1,pb:1,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(a,{children:["Кількість: ",e.quantity," шт"]}),t.jsxs(a,{children:[t.jsx(y,{size:"small",color:"secondary",disabled:u===1,onClick:()=>d({itemId:e.itemId,quantity:String(u-1)}),children:t.jsx(U,{})}),t.jsx(y,{size:"small",color:"secondary",onClick:()=>d({itemId:e.itemId,quantity:String(u+1)}),children:t.jsx(k,{})})]})]}),t.jsxs(a,{sx:{pt:1,pb:1,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(a,{children:["Знижка: ",r,"%"]}),t.jsxs(a,{children:[t.jsx(y,{size:"small",color:"secondary",disabled:r===0,onClick:()=>d({itemId:e.itemId,discount:String(r-1)}),children:t.jsx(U,{})}),t.jsx(y,{size:"small",color:"secondary",onClick:()=>d({itemId:e.itemId,discount:String(r+1)}),children:t.jsx(k,{})})]})]})]})},gt=W(H),jt=()=>t.jsxs(X,{maxWidth:"sm",sx:{height:"100vh",display:"flex",justifyContent:"space-between",flexDirection:"column"},children:[t.jsx(a,{sx:{pt:"90px",color:"text.secondary",typography:"h4",textAlign:"center"},children:t.jsx(et,{sx:{fontSize:"140px",color:"text.secondary"}})}),t.jsx(gt,{to:"/list",fullWidth:!0,variant:"contained",sx:{mb:"30px"},children:t.jsx(F,{color:"secondary"})})]}),bt=()=>t.jsx(a,{sx:{display:"flex",justifyContent:"center",height:"50vh",alignItems:"center"},children:t.jsx(K,{color:"primary"})}),St=W(H),wt=()=>{const{mutate:e}=tt(),r=Q(),u=V(),{data:o=[],isLoading:h}=nt(),d=o.map(l=>({...l,product:J(l.itemId,u)})),m=d.reduce((l,n)=>{var c;const s=((c=n.product)==null?void 0:c.price)||0,i=parseInt(n.quantity,10);return l+s*i},0),x=d.reduce((l,n)=>{var f;const s=((f=n.product)==null?void 0:f.price)||0,i=parseInt(n.quantity,10),c=parseInt(n.discount,10),p=s-Math.ceil(s*c/100);return l+p*i},0),j=d.reduce((l,n)=>{var f;const s=((f=n.product)==null?void 0:f.price)||0,i=parseInt(n.quantity,10),c=parseInt(n.discount,10),p=Math.ceil(s*c/100);return l+p*i},0);return h||r?t.jsx(bt,{}):!h&&o.length===0?t.jsx(jt,{}):t.jsxs(t.Fragment,{children:[t.jsxs(X,{sx:{p:3,maxWidth:"700px",margin:"auto"},children:[d.map(l=>t.jsx(ft,{actions:t.jsx(y,{onClick:()=>{e({itemId:l.itemId,action:"remove"})},sx:{backgroundColor:"red",borderRadius:0,width:"100%",minWidth:"80px",height:"100%"},children:t.jsx(Z,{sx:{color:"white"}})}),children:t.jsx(mt,{item:l})},l.itemId)),t.jsx(B,{}),t.jsxs(a,{sx:{textAlign:"center",mt:2},children:[j>0&&t.jsxs(t.Fragment,{children:[t.jsxs(a,{children:["Разом: ",m," грн"]}),t.jsxs(a,{children:["Знижка:"," ",t.jsxs(a,{sx:{fontWeight:"bold",color:"primary.main"},component:"span",children:[j," грн"]})]})]}),t.jsxs(a,{children:["До оплати: ",x," грн"]})]})]}),t.jsx(a,{sx:{p:3,maxWidth:"700px",margin:"auto"},children:t.jsx(St,{to:"/list",fullWidth:!0,variant:"contained",children:t.jsx(F,{color:"secondary"})})})]})},Dt=G("/cart")({component:wt});export{Dt as Route};
