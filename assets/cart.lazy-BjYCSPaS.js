import{j as n,r as b,d as W,s as G}from"./tanstack-DrrzDSOT.js";import{d as A,B as u,Q as N,x as F,I as y,g as B,e as H,m as K}from"./mui-DvpnWA7j.js";import{A as k,H as X,b as Q,u as V,f as J,D as Z}from"./index-Mz-WqAoK.js";import{u as _,a as nn,b as tn}from"./cart-api-CgqvNpSt.js";import"./react-_uqhELNW.js";import"./html2canvas-BfYXEYrK.js";import"./tesseract-efYOn2sj.js";import"./swiper-B72pzicN.js";const U=A(n.jsx("path",{d:"M19 13H5v-2h14z"}),"Remove"),en=A(n.jsx("path",{d:"M22.73 22.73 2.77 2.77 2 2l-.73-.73L0 2.54l4.39 4.39 2.21 4.66-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h7.46l1.38 1.38c-.5.36-.83.95-.83 1.62 0 1.1.89 2 1.99 2 .67 0 1.26-.33 1.62-.84L21.46 24zM7.42 15c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h2.36l2 2zm8.13-2c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H6.54zM7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2"}),"RemoveShoppingCart"),sn="Left",on="Right",cn="Up",rn="Down",S={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:1/0,touchEventOptions:{passive:!0}},E={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},P="mousemove",q="mouseup",an="touchend",un="touchmove",ln="touchstart";function dn(e,r,a,o){return e>r?a>0?on:sn:o>0?rn:cn}function z(e,r){if(r===0)return e;const a=Math.PI/180*r,o=e[0]*Math.cos(a)+e[1]*Math.sin(a),h=e[1]*Math.cos(a)-e[0]*Math.sin(a);return[o,h]}function hn(e,r){const a=t=>{const s="touches"in t;s&&t.touches.length>1||e((i,c)=>{c.trackMouse&&!s&&(document.addEventListener(P,o),document.addEventListener(q,g));const{clientX:p,clientY:f}=s?t.touches[0]:t,j=z([p,f],c.rotationAngle);return c.onTouchStartOrOnMouseDown&&c.onTouchStartOrOnMouseDown({event:t}),Object.assign(Object.assign(Object.assign({},i),E),{initial:j.slice(),xy:j,start:t.timeStamp||0})})},o=t=>{e((s,i)=>{const c="touches"in t;if(c&&t.touches.length>1)return s;if(t.timeStamp-s.start>i.swipeDuration)return s.swiping?Object.assign(Object.assign({},s),{swiping:!1}):s;const{clientX:p,clientY:f}=c?t.touches[0]:t,[j,M]=z([p,f],i.rotationAngle),v=j-s.xy[0],I=M-s.xy[1],O=Math.abs(v),w=Math.abs(I),C=(t.timeStamp||0)-s.start,Y=Math.sqrt(O*O+w*w)/(C||1),$=[v/(C||1),I/(C||1)],D=dn(O,w,v,I),L=typeof i.delta=="number"?i.delta:i.delta[D.toLowerCase()]||S.delta;if(O<L&&w<L&&!s.swiping)return s;const T={absX:O,absY:w,deltaX:v,deltaY:I,dir:D,event:t,first:s.first,initial:s.initial,velocity:Y,vxvy:$};T.first&&i.onSwipeStart&&i.onSwipeStart(T),i.onSwiping&&i.onSwiping(T);let R=!1;return(i.onSwiping||i.onSwiped||i[`onSwiped${D}`])&&(R=!0),R&&i.preventScrollOnSwipe&&i.trackTouch&&t.cancelable&&t.preventDefault(),Object.assign(Object.assign({},s),{first:!1,eventData:T,swiping:!0})})},h=t=>{e((s,i)=>{let c;if(s.swiping&&s.eventData){if(t.timeStamp-s.start<i.swipeDuration){c=Object.assign(Object.assign({},s.eventData),{event:t}),i.onSwiped&&i.onSwiped(c);const p=i[`onSwiped${c.dir}`];p&&p(c)}}else i.onTap&&i.onTap({event:t});return i.onTouchEndOrOnMouseUp&&i.onTouchEndOrOnMouseUp({event:t}),Object.assign(Object.assign(Object.assign({},s),E),{eventData:c})})},d=()=>{document.removeEventListener(P,o),document.removeEventListener(q,g)},g=t=>{d(),h(t)},x=(t,s)=>{let i=()=>{};if(t&&t.addEventListener){const c=Object.assign(Object.assign({},S.touchEventOptions),s.touchEventOptions),p=[[ln,a,c],[un,o,Object.assign(Object.assign({},c),s.preventScrollOnSwipe?{passive:!1}:{})],[an,h,c]];p.forEach(([f,j,M])=>t.addEventListener(f,j,M)),i=()=>p.forEach(([f,j])=>t.removeEventListener(f,j))}return i},l={ref:t=>{t!==null&&e((s,i)=>{if(s.el===t)return s;const c={};return s.el&&s.el!==t&&s.cleanUpTouch&&(s.cleanUpTouch(),c.cleanUpTouch=void 0),i.trackTouch&&t&&(c.cleanUpTouch=x(t,i)),Object.assign(Object.assign(Object.assign({},s),{el:t}),c)})}};return r.trackMouse&&(l.onMouseDown=a),[l,x]}function xn(e,r,a,o){return!r.trackTouch||!e.el?(e.cleanUpTouch&&e.cleanUpTouch(),Object.assign(Object.assign({},e),{cleanUpTouch:void 0})):e.cleanUpTouch?r.preventScrollOnSwipe!==a.preventScrollOnSwipe||r.touchEventOptions.passive!==a.touchEventOptions.passive?(e.cleanUpTouch(),Object.assign(Object.assign({},e),{cleanUpTouch:o(e.el,r)})):e:Object.assign(Object.assign({},e),{cleanUpTouch:o(e.el,r)})}function pn(e){const{trackMouse:r}=e,a=b.useRef(Object.assign({},E)),o=b.useRef(Object.assign({},S)),h=b.useRef(Object.assign({},o.current));h.current=Object.assign({},o.current),o.current=Object.assign(Object.assign({},S),e);let d;for(d in S)o.current[d]===void 0&&(o.current[d]=S[d]);const[g,x]=b.useMemo(()=>hn(m=>a.current=m(a.current,o.current),{trackMouse:r}),[r]);return a.current=xn(a.current,o.current,h.current,x),g}const fn=({children:e,actions:r})=>{const[a,o]=b.useState(!1),g=pn({onSwipedLeft:()=>o(!0),onSwipedRight:()=>o(!1),preventScrollOnSwipe:!0}),x=b.useRef(null);b.useEffect(()=>{const l=t=>{x.current&&!x.current.contains(t.target)&&o(!1)};return document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[]);const m=l=>{g.ref(l),x.current=l};return n.jsxs(u,{...g,ref:m,sx:{position:"relative",overflow:"hidden",mb:2,"&:hover .top-actions":{display:"block"}},children:[n.jsx(u,{sx:{flex:1},children:e}),n.jsx(u,{className:"top-actions",sx:{display:"none",position:"absolute",right:0,top:0},children:r}),n.jsx(u,{sx:{position:"absolute",right:0,top:0,bottom:0,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",transition:"transform 0.3s ease",transform:a?"translateX(0)":"translateX(100%)"},children:r})]})},gn=({item:e})=>{var g,x,m;const r=parseInt(e.discount,10),a=parseInt(e.quantity,10),o=((g=e.product)==null?void 0:g.price)||0,h=o-o*r/100,{mutate:d}=_();return n.jsxs(N,{variant:"elevation",sx:{p:1},children:[n.jsxs(u,{sx:{mb:2},children:[" ",(x=e.product)==null?void 0:x.name]}),n.jsx(F,{}),h===o&&n.jsxs(u,{sx:{pt:1,pb:1},children:["ціна:"," ",n.jsx(u,{component:"span",sx:{fontWeight:"bold"},children:(m=e.product)==null?void 0:m.price})," ","грн."]}),h!==o&&n.jsxs(u,{sx:{pt:1,pb:1,display:"flex",alignItems:"center"},children:["ціна:",n.jsx(u,{component:"span",sx:{fontWeight:"bold",ml:"2px",mr:"2px"},children:h}),"грн."," ",n.jsxs(u,{component:"span",sx:{textDecoration:"line-through",fontSize:"13px",alignSelf:"flex-end",ml:"6px"},children:[o," грн."]}),n.jsxs(u,{component:"span",sx:{fontWeight:"bold",color:"primary.main",fontSize:"15px",ml:"auto"},children:[(o*r/100).toFixed(2)," грн."]})]}),n.jsxs(u,{sx:{pt:1,pb:1,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsxs(u,{children:["кількість: ",e.quantity]}),n.jsxs(u,{children:[n.jsx(y,{size:"small",color:"secondary",disabled:a===1,onClick:()=>d({itemId:e.itemId,quantity:String(a-1)}),children:n.jsx(U,{})}),n.jsx(y,{size:"small",color:"secondary",onClick:()=>d({itemId:e.itemId,quantity:String(a+1)}),children:n.jsx(k,{})})]})]}),n.jsxs(u,{sx:{pt:1,pb:1,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsxs(u,{children:["знижка: ",r]}),n.jsxs(u,{children:[n.jsx(y,{size:"small",color:"secondary",disabled:r===0,onClick:()=>d({itemId:e.itemId,discount:String(r-1)}),children:n.jsx(U,{})}),n.jsx(y,{size:"small",color:"secondary",onClick:()=>d({itemId:e.itemId,discount:String(r+1)}),children:n.jsx(k,{})})]})]})]})},mn=W(B),jn=()=>n.jsxs(H,{maxWidth:"sm",sx:{height:"100vh",display:"flex",justifyContent:"space-between",flexDirection:"column"},children:[n.jsx(u,{sx:{pt:"90px",color:"text.secondary",typography:"h4",textAlign:"center"},children:n.jsx(en,{sx:{fontSize:"140px",color:"text.secondary"}})}),n.jsx(mn,{to:"/list",fullWidth:!0,variant:"contained",sx:{mb:"30px"},children:n.jsx(X,{color:"secondary"})})]}),bn=()=>n.jsx(u,{sx:{display:"flex",justifyContent:"center",height:"50vh",alignItems:"center"},children:n.jsx(K,{color:"primary"})}),Sn=W(B),On=()=>{const{mutate:e}=nn(),r=Q(),a=V(),{data:o=[],isLoading:h}=tn(),d=o.map(l=>({...l,product:J(l.itemId,a)})),g=d.reduce((l,t)=>{var c;const s=((c=t.product)==null?void 0:c.price)||0,i=parseInt(t.quantity,10);return l+s*i},0).toFixed(2),x=d.reduce((l,t)=>{var f;const s=((f=t.product)==null?void 0:f.price)||0,i=parseInt(t.quantity,10),c=parseInt(t.discount,10),p=s-s*c/100;return l+p*i},0).toFixed(2),m=d.reduce((l,t)=>{var f;const s=((f=t.product)==null?void 0:f.price)||0,i=parseInt(t.quantity,10),c=parseInt(t.discount,10),p=s*c/100;return l+p*i},0);return h||r?n.jsx(bn,{}):!h&&o.length===0?n.jsx(jn,{}):n.jsxs(n.Fragment,{children:[n.jsxs(H,{sx:{p:3,maxWidth:"700px",margin:"auto"},children:[d.map(l=>n.jsx(fn,{actions:n.jsx(y,{onClick:()=>{e({itemId:l.itemId,action:"remove"})},sx:{backgroundColor:"red",borderRadius:0,width:"100%",minWidth:"80px",height:"100%"},children:n.jsx(Z,{sx:{color:"white"}})}),children:n.jsx(gn,{item:l})},l.itemId)),n.jsx(F,{}),n.jsxs(u,{sx:{textAlign:"center",mt:2},children:[m>0&&n.jsxs(n.Fragment,{children:[n.jsxs(u,{children:["Разом: ",g," грн."]}),n.jsxs(u,{children:["Знижка:"," ",n.jsxs(u,{sx:{fontWeight:"bold",color:"primary.main"},component:"span",children:[m.toFixed(2)," грн."]})]})]}),n.jsxs(u,{children:["До оплати: ",x," грн."]})]})]}),n.jsx(u,{sx:{p:3,maxWidth:"700px",margin:"auto"},children:n.jsx(Sn,{to:"/list",fullWidth:!0,variant:"contained",children:n.jsx(X,{color:"secondary"})})})]})},En=G("/cart")({component:On});export{En as Route};
