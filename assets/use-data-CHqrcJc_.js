import{j as l,f as p}from"./tanstack-fTfDZCpD.js";import"./react-BtIrUdbE.js";import{h as f}from"./html2canvas-BfYXEYrK.js";import{k as h}from"./mui-C0rr871i.js";import{j as y,k}from"./index-CtUd9ZlL.js";const v=(t="")=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");function j(t,o,e={match:{sx:{color:"primary.main",fontWeight:"bold"}},noMatch:{}}){if(t===null)return t;const r=t.split(new RegExp(`(${v(o)})`,"gi"));return l.jsx(l.Fragment,{children:r.map((s,n)=>l.jsx(h,{component:"span",...s.toLowerCase()===o.toLowerCase()?e.match:e.noMatch,children:s},n))})}function x(t){const o=new Set;return t.forEach(e=>o.add(e.vendor)),Array.from(o)}async function C(t){try{await navigator.clipboard.writeText(t)}catch(o){console.error("Failed to copy: ",o)}}const D=async()=>{const t=document.getElementById("tiles-view");if(!t)return;const e=(await f(t,{ignoreElements(s){return s.hasAttribute("data-no-export")},onclone(s,n){n.querySelectorAll("input:checked").length>0&&n.querySelectorAll(".product-tile:not(:has(input:checked))").forEach(u=>{u.remove()}),n.querySelectorAll(".product-tile").forEach(i=>{i.style.borderColor="rgba(0, 0, 0, 0.12)"}),n.style.padding="6px"}})).toDataURL("image/png",1),r=document.createElement("a");r.href=e,r.download="screenshot.png",r.click()},E=t=>!!t,F=(t,o)=>t.map(e=>{const r=parseInt(e.stock||"",10),s=o[e.sku].min,n=o[e.sku].max,a=o[e.sku].read,i=[];if(s!==void 0&&r<=s){const c={title:e.name,body:`${e.sku}, цього ${r}, менше ніж ${s}`,min:s,max:n,read:a,sku:e.sku,favoriteId:m(e)};i.push(c)}if(n!==void 0&&r>=n){const c={title:e.name,body:`${e.sku}, цього ${r}, більше ніж ${n}`,min:s,max:n,read:a,sku:e.sku,favoriteId:m(e)};i.push(c)}return i}).flat().filter(E),m=t=>`${t.sku}:${t.vendor}`,T=t=>{const o={month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1};return t.toLocaleString("en-US",o).replace(",","")},S=t=>{const o=t.replace("/*O_o*/","").replace(/\n/g,"").replace("google.visualization.Query.setResponse(","").replace(/\);$/,""),e=JSON.parse(o).table,r=e.cols.map(s=>s.label);return e.rows.map(s=>{const n={};return s.c.forEach((a,i)=>{const c=r[i];if(c==="pics"&&a){const u=a.v.toString();n[c]=u.includes("[")?Array.from(new Set(JSON.parse(u.replace(/'/g,'"')))):[u]}else if(c==="name"&&!a){const u=r.indexOf("sku"),g=s.c[u];n[c]=g?g.v:"-"}else n[c]=(a==null?void 0:a.v)??null}),n})},$=async t=>{if(t.length===0)return[];const o=`https://docs.google.com/spreadsheets/d/${t}/gviz/tq?tqx=out:json&tq&gid=0`,r=await(await fetch(o)).text();return S(r)},d=()=>{const t=y();return p({staleTime:1e3*60*12,queryKey:[k,t],queryFn:()=>$(t)})},L=()=>{const{data:t=[]}=d();return t},N=()=>{const{isFetching:t}=d();return t},R=()=>{const{data:t=[]}=d();return x(t)};export{N as a,m as b,C as c,x as d,L as e,T as f,j as g,D as h,F as i,R as u};
